<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Por un mill√≥n de d√≥lares</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background: linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:#fff;
}

header{
  padding:30px 15px;
  text-align:center;
}

h1{
  margin:0;
  font-size:30px;
}

.subtitle{
  margin-top:10px;
  color:#dcdcdc;
}

.card{
  max-width:900px;
  margin:0 auto;
  background:rgba(0,0,0,0.35);
  backdrop-filter:blur(8px);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,0.4);
}

#map{
  height:60vh;
  border-radius:15px;
  margin-top:15px;
}

.controls{
  text-align:center;
  margin:20px 0;
}

button{
  padding:15px 35px;
  font-size:17px;
  font-weight:bold;
  border:none;
  border-radius:30px;
  cursor:pointer;
  margin:10px;
}

.btn-main{
  background:linear-gradient(135deg,#ffd700,#ffae00);
  color:#000;
}

.btn-yes{
  background:#00c853;
  color:#fff;
}

.btn-no{
  background:#d50000;
  color:#fff;
}

#mensaje{
  text-align:center;
  font-size:18px;
  margin-top:15px;
  min-height:30px;
}
</style>
</head>

<body>

<header>
  <h1>üíµ Por un mill√≥n de d√≥lares</h1>
  <div class="subtitle">
    Oprimes el bot√≥n‚Ä¶ el destino decide d√≥nde caes üåç
  </div>
</header>

<div class="card">
  <div class="controls">
    <button class="btn-main" onclick="jugar()">OPRIMIR EL BOT√ìN</button>
  </div>

  <div id="mensaje"></div>

  <div class="controls" id="decision" style="display:none">
    <button class="btn-yes" onclick="aceptar()">ACEPTO EL MILL√ìN üíµ</button>
    <button class="btn-no" onclick="rechazar()">RECHAZO ‚ùå</button>
  </div>

  <div id="map"></div>
</div>

<audio id="sonido">
  <source src="https://www.soundjay.com/buttons/sounds/button-30.mp3">
</audio>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const map = L.map('map').setView([20,0],2);

// Mapa base
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution:'¬© OpenStreetMap'
}).addTo(map);

// COLORES ALEATORIOS PARA PA√çSES
function colorAleatorio(){
  return `hsl(${Math.random()*360},60%,65%)`;
}

// Capa de pa√≠ses
fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
.then(res=>res.json())
.then(data=>{
  L.geoJSON(data,{
    style:()=>({
      fillColor:colorAleatorio(),
      fillOpacity:0.6,
      color:'#333',
      weight:1
    })
  }).addTo(map);
});

let marcador;

function jugar(){
  document.getElementById("sonido").play();
  document.getElementById("decision").style.display="none";
  document.getElementById("mensaje").innerText="‚è≥ El destino est√° decidiendo...";

  setTimeout(generarLugar,1500);
}

async function generarLugar(){
  const lat=(Math.random()*180-90).toFixed(5);
  const lon=(Math.random()*360-180).toFixed(5);

  if(marcador) map.removeLayer(marcador);

  marcador=L.marker([lat,lon]).addTo(map);
  map.setView([lat,lon],5);

  try{
    const res=await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
    );
    const data=await res.json();

    if(data.address && data.address.country){
      document.getElementById("mensaje").innerText=
        `üåç Ca√≠ste en ${data.address.country}. ¬øAceptas el mill√≥n?`;
    }else{
      document.getElementById("mensaje").innerText=
        `üåä Ca√≠ste en medio del oc√©ano‚Ä¶ ¬øAceptas el mill√≥n?`;
    }

    document.getElementById("decision").style.display="block";

  }catch{
    document.getElementById("mensaje").innerText=
      "El destino decidi√≥‚Ä¶ ¬øAceptas el mill√≥n?";
    document.getElementById("decision").style.display="block";
  }
}

function aceptar(){
  document.getElementById("mensaje").innerText=
    "üíµ Aceptaste el mill√≥n. El destino ya no tiene marcha atr√°s‚Ä¶";
  document.getElementById("decision").style.display="none";
}

function rechazar(){
  document.getElementById("mensaje").innerText=
    "‚ùå Rechazaste el mill√≥n. Elegiste seguridad sobre dinero.";
  document.getElementById("decision").style.display="none";
}
</script>

</body>
</html>
